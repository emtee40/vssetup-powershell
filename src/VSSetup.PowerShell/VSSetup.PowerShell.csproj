<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="Current" Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <ProjectGuid>{F77937D9-8B7C-46AC-80D3-DFDE39EB3279}</ProjectGuid>
    <OutputType>Library</OutputType>
    <RootNamespace>Microsoft.VisualStudio.Setup</RootNamespace>
    <AssemblyName>Microsoft.VisualStudio.Setup.PowerShell</AssemblyName>
    <TargetFramework>net35</TargetFramework>
    <CodeAnalysisRuleSet>..\..\build\Common.ruleset</CodeAnalysisRuleSet>
  </PropertyGroup>
  <PropertyGroup>
    <AssemblyTitle>Visual Studio Setup PowerShell Module</AssemblyTitle>
    <AssemblyDescription>PowerShell module to interact with Visual Studio Setup</AssemblyDescription>
    <AssemblyCompany>Microsoft Corporation</AssemblyCompany>
    <AssemblyProduct>Visual Studio Setup</AssemblyProduct>
    <AssemblyCopyright>Copyright (C) Microsoft Corporation. All rights reserved.</AssemblyCopyright>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="Microsoft.VisualStudio.Setup.Configuration.Interop, Version=1.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
      <HintPath>..\..\packages\Microsoft.VisualStudio.Setup.Configuration.Interop.1.11.2290\lib\net35\Microsoft.VisualStudio.Setup.Configuration.Interop.dll</HintPath>
      <EmbedInteropTypes>True</EmbedInteropTypes>
    </Reference>
    <Reference Include="System" />
    <Reference Include="System.Core" />
    <Reference Include="System.Management.Automation, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
      <HintPath>..\..\packages\Microsoft.PowerShell.2.ReferenceAssemblies.1.0.0\lib\net2\System.Management.Automation.dll</HintPath>
      <Private>False</Private>
    </Reference>
  </ItemGroup>
  <ItemGroup>
    <Compile Update="Properties\Resources.Designer.cs">
      <AutoGen>True</AutoGen>
      <DesignTime>True</DesignTime>
      <DependentUpon>Resources.resx</DependentUpon>
    </Compile>
    <EmbeddedResource Update="Properties\Resources.resx">
      <Generator>ResXFileCodeGenerator</Generator>
      <LastGenOutput>Resources.Designer.cs</LastGenOutput>
    </EmbeddedResource>
  </ItemGroup>
  <ItemGroup>
    <Content Include="VSSetup.types.ps1xml">
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </Content>
    <Content Include="VSSetup.psm1">
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </Content>
    <Template Include="VSSetup.psd1" />
  </ItemGroup>
  <ItemGroup>
    <AdditionalFiles Include="..\..\stylecop.json">
      <Visible>false</Visible>
    </AdditionalFiles>
  </ItemGroup>

  <ItemGroup>
    <PackageReference Include="Microsoft.VisualStudioEng.MicroBuild.Core" version="1.0.0" />
    <PackageReference Include="Microsoft.PowerShell.2.ReferenceAssemblies" version="1.0.0" />
    <PackageReference Include="Microsoft.VisualStudio.Setup.Configuration.Interop" version="1.11.2290" />
    <PackageReference Include="Nerdbank.GitVersioning" version="2.3.186" />
    <PackageReference Include="StyleCop.Analyzers" version="1.1.118" />
    <PackageReference Include="Microsoft.NETFramework.ReferenceAssemblies" Version="1.0.3" />
  </ItemGroup>

  <Import Project="..\..\build\Transform.targets" />
  <Import Project="..\..\build\Version.targets" />

  <Target Name="PopulateFilesToSign" AfterTargets="AfterBuild" BeforeTargets="SignFiles">
    <ItemGroup>
      <FilesToSign Include="$(TargetPath)">
        <Authenticode>Microsoft400</Authenticode>
      </FilesToSign>
      <FilesToSign Include="$(TargetDir)\*.ps1xml;$(TargetDir)\*.psd1;$(TargetDir)\*.psm1">
        <Authenticode>Microsoft400</Authenticode>
      </FilesToSign>
    </ItemGroup>
  </Target>

</Project>